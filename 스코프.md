# 스코프

## 1. 컴파일레이션 Compilation
  - 자바스크립트 엔진은 소스 코드가 실행되기 전에 3단계를 거친다.
    * 토크나이징 / 렉싱 : 문자열을 '토큰'이라 불리는 조각으로 만든다. 
    * 파싱 : 문법 구조를 반영하여 추상 구문 트리 형태로 바꾼다.
    * 코드 생성 : 추상 구문 트리를 실행 코드로 바꾼다.
  - 코드가 실행되기 직전에 수행한다.
  
  
## 2. 스코프
  - 어디에서 어떻게 변수를 찾는 가를 결정하는 규칙의 집합이다.
  - 변수를 검색하는 이유는 변수에 값을 대입하거나(LHS 검색) 변수의 값을 얻어오기 위해서(RHS 검색)이다.
  - 스코프도 다른 스코프 안에 중첩될 수 있다.
  - 대상 변수를 현재 스코프에서 발견하지 못하면 엔진은 상위 스코프로 넘어가거나 글로벌 스코프에 도달할 때까지 변수를 찾고 작업을 중단한다.


## 3. 렉시컬 스코프
  - 렉스타임 : 토큰을 분석하여 상태 유지 파싱의 결과로 생성된 토큰에 의미를 부여한다.
  - 렉시컬 스코프는 코드를 짤 때 변수와 스코프 블록을 어디서 작성하는가에 기초해 렉싱 타임에 정의되는 스코프이다.

  ex 1)
  ```javascript
    function foo(a) {
      var b = a * 5;

      function bar(c) {
        console.log(a, b, c);
      }
      bar(b * 3);
    }
    foo(2); // 2, 10, 30
  ```
  > 엔진은 console.log() 내의 a,b,c 변수를 검색한다.<br />
  > 가장 안쪽 스코프인 bar() 함수의 스코프에서 검색을 시작하고, a를 찾지 못하면 상위 스코프인 foo()로 올라가 검색한다. <br/>여기에서도 찾지 못하면 글로벌 스코프에서 찾는다. <br />
  > 스코프는 일치하는 대상을 찾는 즉시 검색을 중단한다.<br />
  > 이렇게 중첩 스코프를 따라 변수(식별자)를 찾는 과정을 스코프 체인이라고 한다.
  
  ex 2)
  ```javascript
    var a = 10;
    
    function outer() {
      var a = 20;
      inner();
    }
    function inner() {
      console.log(a);
    }
    
    outer(); // 1
    inner(); // 1
      
  ```
  > inner 함수가 선언된 곳은 전역이기 때문에 변수 a는 전역으로 선언된 10의 값을 가진다.
  
  ex 3)
  ```javascript
    var a = 3;
    
    function outer() {
      var a = 5;
       
      function inner() {
        console.log(a);
      }
      inner();
    }
    
    outer(); // 5
  ```
  > inner 함수는 outer 내부의 지역스코프를 가지므로 inner 의 상위 스코프인 outer 함수에서 a 를 찾는다.
  > inner 가 선언된 시점에서 스코프를 가지고 outer 함수와 중첩 스코프가 되어 outer 스코프내에서 검색하게 되므로, 전역 스코프의 var a = 3; 까지 접근하지 않고 검색을 멈추었다.
  
  
